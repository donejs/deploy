#!/usr/bin/env node

var args = require("command-line-args");
var cli = args([
	{ name: "help", alias: "h", type: Boolean, description: "Print usage instructions" },
	{ name: "dir",  alias: "d", type: String,  description: "The build directory", defaultOption: true }
]);
var usage = cli.getUsage({
	header: "donejs-package - Packages up assets not included during the build process.",
	footer: "\n  For more information, visit http://donejs.com"
});

// If an argument is specified, but not accepted an error is thrown
// and caught here
var options = {};
try {
	options = cli.parse();
} catch (e) {
	console.error(e.message);
	process.exit(1);
}

if (options.help) { console.log(usage); process.exit(0); }
try {
	if (!options.dir) { throw new Error("a destination directory must be specified."); }
	require("../lib/package")(options.dir);
} catch (e) {
	console.error("ERROR: " + e.message);
	console.log(usage);
	process.exit(1);
}
process.exit(0);
