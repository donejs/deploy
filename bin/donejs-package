#!/usr/bin/env node

var args = require("command-line-args");
var cli = args([
	{
		name: "help",  alias: "h", type: Boolean,
		description: "Print usage instructions"
	},{
		name: "dir",   alias: "d", type: String,
		description: "The relative path of the build directory",
		defaultOption: true
	},{
		name: "files", alias: "f", type: Array,
		description: "Files to be copied to the build directory (default: package.json 'files')"
	}
]);
var usage = cli.getUsage({
	header: "donejs-package - Copies required assets not included during the build process.",
	footer: "\n  For more information, visit http://donejs.com"
});

var options = {};
try {
	options = cli.parse();
	if (!Object.keys(options).length) { console.log(usage); process.exit(0); }
} catch (e) {
	console.error(e.message);
	process.exit(1);
}

if (options.help) { console.log(usage); process.exit(0); }
try {
	if (!options.dir) {
		throw new Error("a destination directory must be specified.");
	}
	require("../lib/package").package(options.files, options.dir);
} catch (e) {
	console.error("ERROR -- " + e.message);
	process.exit(1);
}
process.exit(0);
